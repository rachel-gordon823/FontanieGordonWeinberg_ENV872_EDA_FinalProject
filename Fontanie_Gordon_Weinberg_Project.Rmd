---
output: 
  pdf_document:
    keep_tex: yes
    fig_caption: yes
    number_sections: yes
geometry: margin=2.54cm
title: "Air Quality in Ukraine post Ukraine-Russia Dispute"
subtitle: "Web address for GitHub repository"
author: "Curly Girlies: Shirley Fontani√©, Rachel Gordon, and Julia Weinberg"
fontsize: 12pt
mainfont: Times New Roman

---

\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage

```{r setup, include=FALSE}
# Set your working directory 

getwd() 

# Load your packages  

library(tidyverse)
library(lubridate)
library(ggplot2)
library(zoo)
library(sf)
library(mapview)
library(leaflet)

mapviewOptions(fgb = FALSE)

# Set your ggplot theme

ourtheme <- theme_classic(base_size = 14)+ 
  theme(axis.text = element_text(color="black"), 
        legend.position = "top")
theme_set(ourtheme)
  
# Load your datasets

UkraineData <- read.csv("./Data/RawData/Ukraine_AQIData.csv", stringsAsFactors = TRUE)

```

# Rationale and Research Questions

> Research question: How does air quality in various Ukrainian cities differ before and after the Ukraine-Russia dispute?  
*******
> Rationale: On February 24, 2022, Russia attacked Ukraine. The first city attacked was
Lviv and Dnipro. 
> Kyiv was hit February 24th.  

\newpage

# Dataset Information 

> Describe sources of data here (input Julia paragraph)

```{r Data wrangling}  
# Initial wrangling 

Ukraine_Processed <- UkraineData %>% 
  drop_na(pm10) %>% 
  drop_na(pm25) 

# Setting Date 

Ukraine_Processed$date <- as.Date(Ukraine_Processed$date, "%m/%d/%y")

# Creating subsets by city  

Dnipro_2021 <- Ukraine_Processed %>% 
  filter(City %in% "Dnipro")%>%
  subset(date > "2021-2-28" & date < "2021-04-01") %>%
  mutate(Month = month(date), 
         Day = day(date), 
          Year = as.factor(year(date)))

                
Dnipro_2022 <- Ukraine_Processed %>%
  filter(City %in% "Dnipro")%>%
  subset(date > "2022-2-28" & date < "2022-04-01") %>%
   mutate(Month = month(date), 
         Day = day(date), 
          Year = as.factor(year(date)))

Lviv_2021 <- Ukraine_Processed %>% 
  filter(City %in% "Lviv") %>%
  subset(date > "2021-2-28" & date < "2021-04-01") %>%
  mutate(Month = month(date), 
         Day = day(date), 
          Year = as.factor(year(date)))

Lviv_2022 <- Ukraine_Processed %>% 
  filter(City %in% "Lviv") %>%
  subset(date > "2022-2-28" & date < "2022-04-01") %>%
  mutate(Month = month(date), 
         Day = day(date), 
          Year = as.factor(year(date)))

FULL_DNIPRO <- bind_rows(Dnipro_2021,Dnipro_2022)

FULL_LVIV <- bind_rows(Lviv_2021,Lviv_2022)

```

> Explain data wrangling process here (shirley do this) 

Data Used | Brief Description 
----------|------------------
UkraineData | (Raw) Ukraine air quality data 
Ukraine_Processed | (Processed) Ukraine air quality data, with no missing values 
Dnipro | (Processed) Dnipro air quality data, showing PM2.5 and PM10 values 
Lviv | (Processed) Lviv air quality data, showing PM2.5 and PM10 values 

\newpage

# Exploratory Analysis  

```{r Plotting.PM25, fig.cap = "Comparing PM2.5 in Dnipro and Lviv, Ukraine"} 
# DNIPRO PM2.5

#group=as.Date(year(Dnipro_2021$date)), color =as.Date(year(Dnipro_2021$date)))
#aes(month(date, label = TRUE, abbr = TRUE)) 

PM25_Dnipro_PLOT <- 
  ggplot(FULL_DNIPRO) + 
  (aes(x = Day, y = pm25, color = Year))+ 
  geom_line()+  
  geom_point()+
  labs(x= "Date", y = "PM2.5",
       title = " Observing PM2.5 Values in Dnipro, Ukraine")
print(PM25_Dnipro_PLOT)
  #annotate(geom = "text", x = as.Date("2022-03-11"), y = 50, label ="March 11, 2022:")+ 
  #annotate(geom = "text", x = as.Date("2022-03-11"), y = 45, label ="Missile Attack")




# LVIV PM2.5
PM25_Lviv_PLOT <- 
  ggplot(FULL_LVIV) + 
(aes(x = Day, y = pm25, color = Year)) + 
              geom_line()+  
  geom_point()+
  labs(x = "Date", y= "PM2.5",
       title = "Observing PM2.5 Values in Lviv Ukraine")
print(PM25_Lviv_PLOT)
  #scale_x_date(limits = as.Date(c("2022-03-01", "2022-03-31")))+ 
  #xlab("Date")+ 
  #ylab("PM2.5")+ 
 # labs(title = "        Observing PM2.5 Values in Lviv, Ukraine")+
  #ylim(0,180)+
 # annotate(geom = "text", x = as.Date("2022-03-18"), y = 165, label ="March 18, 2022:")+ 
  #annotate(geom = "text", x = as.Date("2022-03-18"), y = 155, label ="1st Missile Attack")+ 
  #annotate(geom = "text", x = as.Date("2022-03-26"), y = 110, label ="March 26, 2022:")+ 
  #annotate(geom = "text", x = as.Date("2022-03-26"), y = 100, label ="2nd Missile Attack")

```

```{r Plotting PM10, fig.cap= "Comparing PM10 in Dnipro and Lviv, Ukraine"} 

#DNIPRO PM2.5
PM10_Dnipro_PLOT <-ggplot(FULL_DNIPRO) + 
  (aes(x = Day, y = pm10, color = Year))+ 
  geom_line()+  
  geom_point()+
  labs(x= "Date", y = "PM10",
       title = " Observing PM10 Values in Dnipro, Ukraine")
print(PM10_Dnipro_PLOT) 
            #  geom_line()+  
 # geom_point()+
  #scale_x_date(limits = as.Date(c("2022-03-01", "2022-03-31")))+ 
  #xlab("Date")+ 
  #ylab("PM10")+ 
  #labs(title = "        Observing PM10 Values in Dnipro, Ukraine")+
  #ylim(0,40)+
  #annotate(geom = "text", x = as.Date("2022-03-11"), y = 25, label ="March 11, 2022:")+ 
  #annotate(geom = "text", x = as.Date("2022-03-11"), y = 23, label ="Missile Attack")
  


#LVIV PM10
PM10_Lviv_PLOT <-
  ggplot(FULL_LVIV) + 
(aes(x = Day, y = pm10, color = Year)) + 
              geom_line()+  
  geom_point()+
  labs(x = "Date", y= "PM10",
       title = "Observing PM10 Values in Lviv Ukraine")  
print(PM10_Lviv_PLOT)
  #geom_point()+
  #scale_x_date(limits = as.Date(c("2022-03-01", "2022-03-31")))+ 
  #xlab("Date")+ 
  #ylab("PM10")+ 
  #labs(title = "        Observing PM10 Values in Lviv, Ukraine")+
  #ylim(0,75)+
  #annotate(geom = "text", x = as.Date("2022-03-18"), y = 70, label ="March 18, 2022:")+ 
  #annotate(geom = "text", x = as.Date("2022-03-18"), y = 66, label ="1st Missile Attack")+ 
  #annotate(geom = "text", x = as.Date("2022-03-26"), y = 60, label ="March 26, 2022:")+ 
  #annotate(geom = "text", x = as.Date("2022-03-26"), y = 56, label ="2nd Missile Attack")


```

```{r Plotting Lviv vs Dnipro, fig.cap= "Comparing Air Pollution in Lviv vs Dnipro"}

FULL_Air_quality <- bind_rows(Dnipro_2022,Lviv_2022)

PM25_Lviv_and_Dnipro_PLOT <-
  ggplot(FULL_Air_quality) + 
(aes(x = Day, y = pm25, color = City)) + 
              geom_line()+  
  geom_point()+
  labs(x = "Date", y= "PM25",
       title = "Observing PM25 Values in 2022 Lviv and Dnipro Ukraine")  
print(PM25_Lviv_and_Dnipro_PLOT)

PM10_Lviv_and_Dnipro_PLOT <-
  ggplot(FULL_Air_quality) + 
(aes(x = Day, y = pm10, color = City)) + 
              geom_line()+  
  geom_point()+
  labs(x = "Date", y= "PM10",
       title = "Observing PM10 Values in 2022 Lviv and Dnipro Ukraine")  
print(PM10_Lviv_and_Dnipro_PLOT)


```


\newpage

# Analysis
```{r anova analysis}

#after doing all these anovas i realized im not sure what this is really telling us and i think they might be super uncessary so i did an lm analysis in the code chunk below

lviv.pm25.anova <- aov(data = FULL_LVIV , pm25 ~ Year)
summary(lviv.pm25.anova)

lviv.pm10.anova <- aov(data = FULL_LVIV , pm10 ~ Year)
summary(lviv.pm10.anova)

dnipro.pm25.anova <- aov(data = FULL_DNIPRO , pm25 ~ Year)
summary(dnipro.pm25.anova)

dnipro.pm10.anova <- aov(data = FULL_DNIPRO , pm10 ~ Year)
summary(dnipro.pm10.anova)

dnipro.lviv.pm25.anova <- aov(data = FULL_Air_quality , pm25 ~ City)
summary(dnipro.lviv.pm25.anova)

dnipro.lviv.pm10.anova <- aov(data = FULL_Air_quality , pm10 ~ City)
summary(dnipro.lviv.pm10.anova)
```

```{r lm analysis}

lviv.25.lm <- lm(data = FULL_LVIV, pm25 ~ Year) 
summary(lviv.25.lm) 

lviv.10.lm <- lm(data = FULL_LVIV, pm10 ~ Year) 
summary(lviv.10.lm) 

dnipro.25.lm <- lm(data = FULL_DNIPRO, pm25 ~ Year) 
summary(dnipro.25.lm) 

dnipro.10.lm <- lm(data = FULL_DNIPRO, pm10 ~ Year) 
summary(dnipro.10.lm) 

dnipro.lviv.pm25.lm <- lm(data = FULL_Air_quality, pm25 ~ City) 
summary(dnipro.lviv.pm25.lm)

dnipro.lviv.pm10.lm <- lm(data = FULL_Air_quality, pm10 ~ City) 
summary(dnipro.lviv.pm10.lm)
```

```{r mapping lviv and dnipro}
#I'm confused if we need to upload a shapefile of ukraine so that we can make a map but maybe im really overthinking this - just wanted to put it as a comment here so i dont forget 

#https://simplemaps.com/data/ua-cities
#we can download a csv of all the cities with lat and long from this link and we could make a map but idk if thats what you guys were thinking
```

## Question 1: <insert specific question here and add additional subsections for additional questions below, if needed>

## Question 2: 




\newpage

# Summary and Conclusions


\newpage

# References
<add references here if relevant, otherwise delete this section> 
